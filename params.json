{"tagline":"Check for validity of NT/LM credentials across a network over SMB","note":"Don't delete this file! It's used internally to help with page regeneration.","name":"keimpx","google":"UA-32960908-1","body":"# Introduction\r\n\r\nkeimpx is an open source tool, released under a modified version of Apache License 1.1.\r\n\r\nIt can be used to quickly check for valid credentials across a network over SMB. Credentials can be:\r\n\r\n* Combination of **user / plain-text password**.\r\n* Combination of **user / NTLM hash**.\r\n* Combination of **user / NTLM logon session token**.\r\n\r\nIf any valid credentials has been discovered across the network after its attack phase, the user is asked to choose which host to connect to and which valid credentials to use, then he will be prompted with an **interactive SMB shell** where the user can:\r\n\r\n* Spawn an interactive command prompt.\r\n* Navigate through the remote SMB shares: list, upload, download files, create, remove files, etc.\r\n* Deploy and undeploy his own service, for instance, a backdoor listening on a TCP port for incoming connections.\r\n* List users details, domains and password policy.\r\n* More to come, see the [issues](https://github.com/inquisb/keimpx/issues) page.\r\n\r\n## Dependencies\r\n\r\nIt is developed in [Python](http://www.python.org) using CORE Impact's [Impacket](http://code.google.com/p/impacket/) library: **you need to install the latest development version from its Google Code subversion repository** otherwise keimpx won't work. This Python library requires also [PyCrypto](http://www.dlitz.net/software/pycrypto/) to work. If you want to run keimpx on Windows, you might find useful the prebuilt [PyCrypto binaries](http://www.voidspace.org.uk/python/modules.shtml#pycrypto).\r\n\r\n## Usage\r\n\r\nLet's say you are performing an infrastructure penetration test of a large network, you \r\n[owned](http://metasploit.com/) a Windows workstation, [escalated](http://corelabs.coresecurity.com/index.php?module=Wiki&action=view&type=tool&name=Pass-The-Hash_Toolkit) [your](http://www.mwrinfosecurity.com/publications/mwri_security-implications-of-windows-access-tokens_2008-04-14.pdf) [privileges](http://technet.microsoft.com/en-us/sysinternals/bb664922.aspx) to `Administrator` or `LOCAL SYSTEM` and [dumped password hashes](http://bernardodamele.blogspot.com/search/label/dump).\r\n\r\nYou also enumerated the list of machines within the Windows domain via `net` command, ping sweep, ARP scan and network traffic sniffing.\r\n\r\nNow, what if you want to check for the validity of the dumped hashes **without the need to crack them** across the whole Windows network over SMB? What if you want to login to one or more system using the dumped NTLM hashes then surf the shares or even spawn a command prompt?\r\n\r\n**Fire up keimpx and let it do the work for you!**\r\n\r\nAnother scenario where it comes handy is discussed in [this blog post](http://bernardodamele.blogspot.com/2009/11/abuse-citrix-and-own-domain.html).\r\n\r\n## Help message\r\n\r\n        keimpx 0.3-dev\r\n        by Bernardo Damele A. G. <bernardo.damele@gmail.com>\r\n        \r\n    Usage: keimpx.py [options]\r\n\r\n    Options:\r\n      --version       show program's version number and exit\r\n      -h, --help      show this help message and exit\r\n      -v VERBOSE      Verbosity level: 0-2 (default: 0)\r\n      -t TARGET       Target address\r\n      -l LIST         File with list of targets\r\n      -U USER         User\r\n      -P PASSWORD     Password\r\n      --nt=NTHASH     NT hash\r\n      --lm=LMHASH     LM hash\r\n      -c CREDSFILE    File with list of credentials\r\n      -D DOMAIN       Domain\r\n      -d DOMAINSFILE  File with list of domains\r\n      -p PORT         SMB port: 139 or 445 (default: 445)\r\n      -n NAME         Local hostname\r\n      -T THREADS      Maximum simultaneous connections (default: 10)\r\n      -b              Batch mode: do not ask to get an interactive SMB shell\r\n      -x EXECUTELIST  Execute a list of commands against all hosts\r\n\r\nFor examples see [this wiki page](https://github.com/inquisb/keimpx/wiki/Examples).\r\n\r\n## Frequently Asked Questions\r\n\r\nSee [this wiki page](https://github.com/inquisb/keimpx/wiki/FAQ).\r\n\r\n## License\r\n\r\nI provide this software under a slightly modified version of the Apache Software License. The only changes to the document were the replacement of \"Apache\" with \"keimpx\" and \"Apache Software Foundation\" with \"Bernardo Damele A. G.\". Feel free to compare the resulting document to the official Apache license.\r\n\r\nThe `Apache Software License' is an Open Source Initiative Approved License.\r\n\r\nThe Apache Software License, Version 1.1\r\nModifications by Bernardo Damele A. G. (see above)\r\n\r\nCopyright (c) 2009-2012 Bernardo Damele A. G. <bernardo.damele@gmail.com>\r\nAll rights reserved.\r\n\r\nThis product includes software developed by CORE Security Technologies\r\n(http://www.coresecurity.com/).\r\n\r\nTHIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED\r\nWARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\r\nOF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\r\nDISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR\r\nITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\r\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\r\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF\r\nUSE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\r\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\r\nOR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\r\nOF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\r\nSUCH DAMAGE.\r\n\r\n## Contributors\r\n\r\nThanks to:\r\n\r\n* [deanx](mailto:deanx@65535.com) - for developing [polenum](http://labs.portcullis.co.uk/application/polenum/) tool and some classes ripped from him.\r\n* [frego](mailto:frego@0x3f.net) - for his Windows service bind-shell executable and help with the service deploy/undeploy methods.\r\n* [gera](mailto:gera@coresecurity.com), [beto](mailto:bethus@gmail.com) and the rest of the [CORE Security](http://corelabs.coresecurity.com) guys - for developing such amazing Python [library](http://code.google.com/p/impacket/) and providing it with [examples](http://code.google.com/p/impacket/source/browse/#svn%2Ftrunk%2Fexamples)."}